---
import { Image } from "astro:assets";
import Layout from "~/layouts/Layout.astro";
import Section from "~/components/Section.astro";
import Container from "~/components/Container.astro";
import Article from "~/components/Article.astro";
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
	const posts = await getCollection("blog");
	return posts.map((post) => ({
		params: { slug: post.id },
		props: { post },
	}));
}

const { post } = Astro.props;
const { Content } = await render(post);
---

<Layout>
	<Section>
		<Container>
			<Article contain>
				<h1>
					{post.data.title}
				</h1>

				<time class="text-base text-gray-600 italic" datetime={post.data.publishDate.toISOString()}>
					Posted on: {post.data.publishDate.toLocaleDateString()}
				</time>

				<Image class:list={"rounded-lg"} src={post.data.image} alt={post.data.imageAlt} />

				<Content />
			</Article>
		</Container>
	</Section>
</Layout>
